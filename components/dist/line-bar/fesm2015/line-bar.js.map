{"version":3,"file":"line-bar.js.map","sources":["ng://line-bar/lib/line-bar.component.ts","ng://line-bar/lib/line-bar.module.ts","ng://line-bar/public-api.ts"],"sourcesContent":["import { Component, OnInit } from \"@angular/core\";\nimport { PluginManagerService, componentData } from \"plugin-manager\";\n\nconst echarts: any = (window as any).echarts;\n\n@Component({\n  selector: \"lib-line-bar\",\n  templateUrl: \"./line-bar.component.html\",\n  styleUrls: [\"./line-bar.component.styl\"],\n})\nexport class LineBarComponent implements OnInit {\n  data: any;\n  color: any;\n  chartOptions: any = {};\n  chart: any; // å¾è¡¨æ¬èº«\n  resizeTimer: any;\n\n  constructor(\n    private pluginManagerService: PluginManagerService,\n    comData: componentData\n  ) {\n    // æ¥æ¶ä¸­é´ä»¶ä¼ å¼\n    console.log(\"comData\", comData);\n    this.data = comData.configData.data;\n    this.color = comData.configData.color;\n  }\n\n  ngOnInit() {\n    this.initChart();\n    this.renderChart();\n\n    window.addEventListener(\"resize\", () => {\n      clearTimeout(this.resizeTimer);\n      this.resizeTimer = setTimeout(() => {\n        this.initChart();\n        this.renderChart();\n      }, 250);\n    });\n  }\n\n  ngAfterViewInit(): void {\n    // Initialize the chart after the view is initialized\n  }\n\n  initChart() {\n    console.log(\"init\");\n    const chartDom = document.getElementById(\"chartContainer\")!;\n\n    this.chart = echarts.init(chartDom);\n  }\n\n  renderChart() {\n    const { legend = {}, seriesMap = {} } = this.color;\n    const { xAxis = {}, series = [] } = this.data;\n    const { data: xAxisData = [] } = xAxis;\n    const seriesData = [];\n    const legendData = [];\n\n    function getBorderHeight(list = []) {\n      const sum = list.reduce((acc, curr) => acc + curr, 0);\n      const average = sum / list.length / 40 * 1.5;\n      const arr = Array(list.length).fill(average);\n\n      return arr;\n    }\n\n    series.forEach((item, index) => {\n      const styleObj = seriesMap[item.key] || {};\n\n      if (item.type === \"line\") {\n        seriesData.push({\n          ...item,\n          step: true,\n          lineStyle: {\n            color: styleObj.itemColor || (index === 2 ? \"#50FFCC\" : \"#52D2FF\"),\n          },\n          itemStyle: {\n            color: styleObj.itemColor || (index === 2 ? \"#50FFCC\" : \"#52D2FF\"),\n            opacity: 0,\n          },\n          showBackground: index === 0,\n          backgroundStyle: {\n            color: \"rgba(255, 255, 255, 0.05)\",\n          },\n        });\n\n        legendData.push({\n          name: item.name,\n          icon: \"path://M 0 0 H 10 V 2 H 0 Z\",\n        });\n      }\n      if (item.type === \"bar\") {\n        if (styleObj.borderColor || (index === 0 && !styleObj.itemColor)) {\n          seriesData.push(\n            {\n              ...item,\n              name: '',\n              stack: 1,\n              barGap: \"0\",\n              borderWidth: 0,\n              itemStyle: {\n                normal: {\n                  color: new echarts.graphic.LinearGradient(\n                    0,\n                    0,\n                    0,\n                    1,\n                    [\n                      {\n                        offset: 0,\n                        color:\n                          (styleObj.itemColor && styleObj.itemColor[0]) ||\n                          \"rgba(82, 210, 255, 0.3)\",\n                      },\n                      {\n                        offset: 0.3,\n                        color:\n                          (styleObj.itemColor && styleObj.itemColor[1]) ||\n                          \"rgba(82, 210, 255, 0)\",\n                      },\n                    ],\n                    false\n                  ),\n                },\n              },\n              showBackground: index === 0,\n              backgroundStyle: {\n                color: \"rgba(255, 255, 255, 0.05)\",\n              },\n            },\n            {\n              type: \"bar\",\n              name: item.name,\n              stack: 1,\n              barGap: \"0\",\n              itemStyle: {\n                normal: {\n                  color: styleObj.borderColor || \"rgba(82, 210, 255, 1)\",\n                },\n              },\n              label: {\n                normal: {\n                  show: false,\n                },\n              },\n              data: getBorderHeight(item.data),\n              tooltip: {\n                show: false,\n              },\n            }\n          );\n        } else {\n          seriesData.unshift({\n            ...item,\n            stack: 1,\n            itemStyle: {\n              color: styleObj.itemColor || \"#FF435B\",\n            },\n            showBackground: index === 0,\n            backgroundStyle: {\n              color: \"rgba(255, 255, 255, 0.05)\",\n            },\n          });\n        }\n\n        legendData.push({\n          name: item.name,\n          icon: \"path://M 0 0 H 8 V 8 H 0 Z\",\n        });\n      }\n    });\n\n    const option = {\n      tooltip: {\n        trigger: \"axis\",\n        axisPointer: {\n          type: \"shadow\",\n        },\n      },\n      legend: {\n        icon: \"rect\",\n        itemWidth: 10,\n        // itemHeight: 2,\n        itemGap: 18,\n        textStyle: {\n          color: \"#fff\",\n        },\n        top: 20,\n        right: 20,\n        ...legend,\n        data: legendData,\n      },\n      grid: {\n        left: \"3%\",\n        right: \"4%\",\n        bottom: \"3%\",\n        containLabel: true,\n      },\n      xAxis: {\n        type: \"category\",\n        axisLabel: {\n          color: \"#BABBCA\",\n          fontSize: 14,\n        },\n        axisLine: {\n          show: false,\n        },\n        splitLine: {\n          show: false,\n        },\n        axisTick: {\n          show: false,\n        },\n        // boundaryGap: false\n        data: xAxisData,\n      },\n      yAxis: {\n        type: \"value\",\n        nameTextStyle: {\n          fontSize: 14,\n          color: \"#BABBCA\",\n        },\n        axisLabel: {\n          width: 20,\n          fontSize: 14,\n          color: \"#BABBCA\",\n        },\n        axisLine: {\n          show: false,\n        },\n        axisTick: {\n          show: false,\n        },\n        splitLine: {\n          lineStyle: {\n            type: \"dashed\",\n            color: \"rgba(198, 198, 198, 0.40)\",\n          },\n        },\n      },\n      series: seriesData,\n    };\n\n    this.chart.clear();\n    this.chart.setOption(option, false);\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { LineBarComponent } from './line-bar.component';\nimport { NgZorroAntdModule } from 'ng-zorro-antd';\nimport { CommonModule } from '@angular/common'\n\n@NgModule({\n  declarations: [LineBarComponent],\n  entryComponents: [LineBarComponent],\n  imports: [CommonModule, NgZorroAntdModule],\n  exports: [LineBarComponent]\n})\n\nexport class LineBarModule { }\n","import { createPlugin } from \"plugin-manager\";\nimport { LineBarComponent } from \"./lib/line-bar.component\";\nimport { LineBarModule } from \"./lib/line-bar.module\";\n\nexport default createPlugin({\n  name: \"line-bar\",\n  module: LineBarModule,\n  component: LineBarComponent,\n});\n"],"names":[],"mappings":"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"}
