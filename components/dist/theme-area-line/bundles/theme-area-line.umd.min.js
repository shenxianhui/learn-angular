!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("plugin-manager"),require("@angular/core"),require("ng-zorro-antd"),require("@angular/common")):"function"==typeof define&&define.amd?define("theme-area-line",["plugin-manager","@angular/core","ng-zorro-antd","@angular/common"],e):t["theme-area-line"]=e(t.pluginManager,t.ng.core,t.ngZorroAntd,t.ng.common)}(this,function(t,e,n,r){"use strict";var E=function(){return(E=Object.assign||function E(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)};window.$,window.echarts;var w=window.d3,a=(i.prototype.ngOnInit=function(){var t=this;this.initChart(),window.addEventListener("resize",function(){clearTimeout(t.resizeTimer),t.resizeTimer=setTimeout(function(){w.select(t.themelineDiv.nativeElement).selectAll("svg").remove(),t.initChart()},250)})},i.prototype.initChart=function(){var t,e,n=this,r=this.data.map(function(t,e){return E({},t,{x:e+1})}),a=20,i=20,l=30,o=50,s=parseInt(this.themelineDiv.nativeElement.offsetWidth)-o-i,c=parseInt(this.themelineDiv.nativeElement.offsetHeight)-a-l,u=w.scaleLinear().domain([0,1.1*w.max(r,function(t){return t.x})]).range([0,s]),d=w.scaleLinear().domain([0,0==w.max(r,function(t){return t.num})?220:1.1*w.max(r,function(t){return t.num})]).range([c,0]),p=w.axisBottom(u).tickValues(w.range(1,r.length+1)).tickFormat(function(t){return r[t-1].hour||t}),f=w.axisLeft(d).tickValues(d.ticks(4).filter(function(t){return 0!==t})).tickSize(90-s),m=w.line().x(function(t){return u(t.x)}).y(function(t){return d(t.num)}),h=w.area().x(function(t){return u(t.x)}).y0(c).y1(function(t){return d(t.num)}),i=w.select(this.themelineDiv.nativeElement).append("svg").attr("class","svg-box").attr("width",s+o+i).attr("height",c+a+l).append("g").attr("transform","translate("+o+", "+a+")"),l=(this.svgCur=i,this.color.areaColor||"linear-gradient(rgba(51,165,255,0.20), rgba(51,194,255,0.60))"),o=l.matchAll(/rgba\((\d+),(\d+),(\d+),([\d\.]+)\)/g),x=[];try{for(var y=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(o),g=y.next();!g.done;g=y.next()){var v=g.value;x.push("rgba("+v[1]+","+v[2]+","+v[3]+","+v[4]+")")}}catch(D){t={error:D}}finally{try{g&&!g.done&&(e=y["return"])&&e.call(y)}finally{if(t)throw t.error}}var b=l.match(/(\d+)/g).join("");i.append("defs").append("linearGradient").attr("id","area-gradient-"+b).attr("gradientUnits","userSpaceOnUse").attr("x1",0).attr("y1",d(0)).attr("x2",0).attr("y2",d(1.1*w.max(r,function(t){return t.num}))).selectAll("stop").data(x).enter().append("stop").attr("offset",function(t,e){return 100*e/(x.length-1)+"%"}).attr("stop-color",function(t){return t}),i.append("g").attr("class","axis").attr("class","axisx").attr("transform","translate(0, "+c+")").call(p),i.append("g").attr("class","axis").call(f).selectAll(".tick line").attr("transform","translate(55,0)").attr("stroke-dasharray","10,15"),i.append("path").datum(r).attr("class","area").attr("d",h).style("fill",function(){return"url(#area-gradient-"+b+")"}),i.append("path").datum(r).attr("class","line").attr("d",m),i.selectAll(".bar").data(r).enter().append("rect").attr("class","bar").attr("x",function(t){return u(t.x)-s/12/2}).attr("y",20).attr("width",s/12).attr("height",c-20).style("fill","rgba(255, 255, 255, 0.1)").on("mouseover",function(t,e){w.select(n.themelineDiv.nativeElement).select("#tooltip-"+e.x).style("display","inline"),w.select(n.themelineDiv.nativeElement).select("#dot-"+e.x).style("display","inline"),w.select(n.themelineDiv.nativeElement).select("#vertical-line-"+e.x).style("display","inline"),w.select(n.themelineDiv.nativeElement).select("#triangle-"+e.x).style("display","inline"),w.select(n.themelineDiv.nativeElement).select("#bottom-bar-"+e.x).style("fill",function(){return n.color.scaleLineColor||"#46B9E6"}),w.select(t.currentTarget).style("fill",function(){return n.color.markLineBgColor||"rgba(255, 255, 255, 0.3)"})}).on("mouseout",function(t,e){w.select(n.themelineDiv.nativeElement).select("#tooltip-"+e.x).style("display","none"),w.select(n.themelineDiv.nativeElement).select("#vertical-line-"+e.x).style("display","none"),w.select(n.themelineDiv.nativeElement).select("#triangle-"+e.x).style("display","none"),w.select(n.themelineDiv.nativeElement).select("#bottom-bar-"+e.x).style("fill",e.x%2==0?"#A3A5A9":"#62686F"),w.select(n.themelineDiv.nativeElement).select("#dot-"+e.x).style("display","none"),w.select(t.currentTarget).style("fill","rgba(255, 255, 255, 0.1)")}),i.selectAll(".vertical-line").data(r).enter().append("line").style("stroke",function(){return n.color.markLineColor||"#46B9E6"}).attr("class","vertical-line").attr("id",function(t){return"vertical-line-"+t.x}).attr("x1",function(t){return u(t.x)}).attr("y1",20).attr("x2",function(t){return u(t.x)}).attr("y2",c),i.selectAll(".triangle").data(r).enter().append("polygon").attr("class","triangle").attr("id",function(t){return"triangle-"+t.x}).attr("points",function(t){return u(t.x)+",30 "+(u(t.x)-5)+",20 "+(u(t.x)+5)+",20"}),i.selectAll(".tooltip").data(r).enter().append("text").attr("class","tooltip").attr("id",function(t){return"tooltip-"+t.x}).attr("x",function(t){return u(t.x)}).attr("y",function(t){return 10}).html(function(t){var e=n.color.scaleLineColor||"#46B9E6";return"<tspan style='fill:"+e+";'>[ </tspan><tspan>"+t.num+"</tspan><tspan style='fill:"+e+";'> ]</tspan>"}),i.selectAll(".axis .tick text").style("font-size","14px").attr("transform","translate(30,0)"),i.selectAll(".dot").data(r).enter().append("circle").attr("class","dot").style("fill",function(){return n.color.dotColor||"#46B9E6"}).attr("id",function(t){return"dot-"+t.x}).attr("cx",function(t){return u(t.x)}).attr("cy",function(t){return d(t.num)}).attr("r",7),i.selectAll(".bottom-bar").data(r).enter().append("rect").attr("id",function(t){return"bottom-bar-"+t.x}).attr("class","bottom-bar").attr("x",function(t){return u(t.x)-s/10/2+9}).attr("y",c-2).attr("width",s/10-18).attr("height",5),i.append("text").attr("class","x label").attr("text-anchor","start").attr("x",0).attr("y",c+a).style("fill","#FFF").style("font-size","14px").text("时刻")},i.decorators=[{type:e.Component,args:[{selector:"lib-theme-area-line",template:'<div class="theme-line-box" #themeline></div>',styles:[".theme-line-box{width:100%;height:100%;color:#fff}/deep/ .line{fill:none;stroke:#4682b4;stroke-width:2px}/deep/ .axisx{font-size:14px}/deep/ .axisx line{display:none}/deep/ .dot{display:none}/deep/ .tooltip{display:none;font-family:sans-serif;font-size:14px;fill:#fff;text-anchor:middle}/deep/ .axis path{display:none}/deep/ .data-label{font-family:sans-serif;font-size:11px;text-anchor:middle;display:none}/deep/ .vertical-line{display:none;stroke-width:1px}/deep/ .triangle{display:none;fill:#46b9e6}/deep/ .bottom-bar{fill:#a3a5a9}/deep/ .bottom-bar:nth-child(odd){fill:#62686f}/deep/ .axisx path{stroke:none}"]}]}],i.ctorParameters=function(){return[{type:t.PluginManagerService},{type:t.componentData}]},i.propDecorators={themelineDiv:[{type:e.ViewChild,args:["themeline"]}]},i);function i(t,e){this.pluginManagerService=t,console.log("comData测试",e),this.data=e.configData.data,this.color=e.configData.color}function l(){}return l.decorators=[{type:e.NgModule,args:[{declarations:[a],entryComponents:[a],imports:[r.CommonModule,n.NgZorroAntdModule],exports:[a]}]}],t.createPlugin({name:"theme-area-line",module:l,component:a})});
//# sourceMappingURL=theme-area-line.umd.min.js.map